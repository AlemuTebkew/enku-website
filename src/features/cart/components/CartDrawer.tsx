`use client`
import React from 'react';
import { Drawer, IconButton } from '@mui/material';
import ArrowBackIcon from '@mui/icons-material/ArrowBack';
import { useAppDispatch, useAppSelector } from '@/store/app-store-hooks';
import { RootState } from '@/store/app-store';
import { Button } from '@/components/ui/button';
import { clearCart, removeItem } from '../store/cart-slice';

interface CartDrawerProps {
  isOpen: boolean;
  onClose: () => void;
}

const CartDrawer: React.FC<CartDrawerProps> = ({ isOpen, onClose }) => {
  const items = useAppSelector((state: RootState) => state.cart.items);
  const dispatch = useAppDispatch();

 return (
    <Drawer
      anchor="right"
      open={isOpen}
      onClose={onClose}
      classes={{ paper: 'w-full sm:max-w-md' }}
    >
      <div className="relative h-full flex flex-col">
        <div className="flex items-center p-4 border-b border-gray-200">
          <IconButton onClick={onClose} className="mr-2">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g opacity="0.92"><path d="M21.51 11.2108H5.42L10.93 5.71079C11.0237 5.61783 11.0981 5.50723 11.1489 5.38537C11.1997 5.26351 11.2258 5.1328 11.2258 5.00079C11.2258 4.86878 11.1997 4.73808 11.1489 4.61622C11.0981 4.49436 11.0237 4.38376 10.93 4.29079C10.7426 4.10454 10.4892 4 10.225 4C9.96081 4 9.70736 4.10454 9.52 4.29079L2.3 11.5008C2.20551 11.5934 2.13034 11.7039 2.07885 11.8257C2.02735 11.9476 2.00055 12.0785 2 12.2108C2.00055 12.3431 2.02735 12.474 2.07885 12.5959C2.13034 12.7177 2.20551 12.8282 2.3 12.9208L9.51 20.1308C9.6983 20.3191 9.9537 20.4249 10.22 20.4249C10.4863 20.4249 10.7417 20.3191 10.93 20.1308C11.1183 19.9425 11.2241 19.6871 11.2241 19.4208C11.2241 19.1545 11.1183 18.8991 10.93 18.7108L5.43 13.2108H21.51C21.7752 13.2108 22.0296 13.1054 22.2171 12.9179C22.4046 12.7304 22.51 12.476 22.51 12.2108C22.51 11.9456 22.4046 11.6912 22.2171 11.5037C22.0296 11.3161 21.7752 11.2108 21.51 11.2108Z" fill="black"></path></g></svg>
          </IconButton>
          <h2 className="text-lg font-bold leading-relaxed tracking-widest">Bag</h2>
        </div>
        <div className="p-4 flex-1 overflow-auto">
          {items.length > 0 ? (
            items.map((item) => (
              <div key={item.id} className="flex items-center justify-between mb-4">
                <div>
                  <h3 className="text-sm font-bold">{item.name}</h3>
                  <p className="text-sm">{item.quantity} x ${item.price}</p>
                </div>
                <Button onClick={() => dispatch(removeItem(item.id))}>Remove</Button>
              </div>
            ))
          ) : (
            <div className="flex items-center justify-center mx-10">
              <div>
                <div data-test-id="empty_bag">
                  <div>
                    <div className="text-center flex flex-col gap-4">
                      <span className="flex items-center justify-center mb-4">
                      <svg width="182" height="186" viewBox="0 0 182 186" fill="none" xmlns="http://www.w3.org/2000 svg">
                      <g clip-path="url(#clip0_46_668)">
                      <mask id="mask0_46_668" maskUnits="userSpaceOnUse" x="0" y="0" width="182" height="186">
                      <path d="M181.605 0H0V186H181.605V0Z" fill="white"/>
                      </mask>
                      <g mask="url(#mask0_46_668)">
                      <path d="M67.4009 176.307L9.61955 118.526C-3.20961 105.697 -3.20961 84.6433 9.61955 71.7138L67.4009 13.9325C80.2301 1.10331 101.284 1.10331 114.213 13.9325L171.995 71.7138C184.824 84.543 184.824 105.597 171.995 118.526L114.213 176.307C101.284 189.237 80.3304 189.237 67.4009 176.307Z" fill="#FDE3E0"/>
                      <path d="M97.1534 135.613C96.5243 135.54 95.886 135.468 95.2568 135.404C95.3207 136.398 96.3328 147.804 108.104 149.518L108.378 147.658C98.667 146.245 97.3266 137.528 97.1534 135.613Z" fill="#45AAAA"/>
                      <path d="M87.862 168.092L86.8772 166.642C91.2083 163.706 93.2599 159.366 92.9863 153.731C92.7766 149.436 91.2265 145.962 91.2083 145.926L92.804 145.197C92.8678 145.352 99.4602 160.223 87.862 168.092Z" fill="white"/>
                      <path d="M101.676 168.092C103.166 168.092 104.375 166.884 104.375 165.393C104.375 163.903 103.166 162.694 101.676 162.694C100.185 162.694 98.9768 163.903 98.9768 165.393C98.9768 166.884 100.185 168.092 101.676 168.092Z" fill="white"/>
                      <path d="M81.3699 154.916C82.8604 154.916 84.0688 153.708 84.0688 152.217C84.0688 150.727 82.8604 149.518 81.3699 149.518C79.8793 149.518 78.6709 150.727 78.6709 152.217C78.6709 153.708 79.8793 154.916 81.3699 154.916Z" fill="#EC8BB9"/>
                      <path d="M79.724 113.756C81.5821 113.258 82.6349 111.163 82.0756 109.076C81.5163 106.99 79.5566 105.702 77.6986 106.2C75.8405 106.698 74.7876 108.793 75.347 110.88C75.9063 112.967 77.8659 114.254 79.724 113.756Z" fill="#BCBEC0"/>
                      <path d="M104.362 107.156C106.221 106.658 107.273 104.562 106.714 102.476C106.155 100.389 104.195 99.1011 102.337 99.5991C100.479 100.097 99.4261 102.193 99.9854 104.279C100.545 106.366 102.504 107.654 104.362 107.156Z" fill="#BCBEC0"/>
                      <path d="M100.408 132.395L98.8857 132.805C91.4363 134.793 83.7315 130.644 81.2969 123.331L77.0935 110.694L80.5128 109.572L84.698 122.192C86.549 127.69 92.3481 130.817 97.9557 129.331L99.4784 128.921C104.539 127.562 107.539 122.365 106.18 117.304C106.135 117.122 106.08 116.949 106.016 116.775L101.794 104.074L105.214 102.952L109.435 115.636C111.706 122.502 107.986 129.905 101.12 132.185C100.883 132.258 100.646 132.331 100.408 132.395Z" fill="#BCBEC0"/>
                      <path d="M49.5295 63.0152L88.8011 50.6693C98.1654 47.7241 108.15 52.9306 111.095 62.2948L125.073 106.736L51.8819 129.75L37.9039 85.3089C34.9587 75.9446 40.1652 65.9603 49.5295 63.0152Z" fill="#E04D4C"/>
                      <path d="M64.4193 58.3376L100.235 47.0767C110.557 43.8307 121.553 49.566 124.799 59.8876L138.23 102.597L65.0394 125.611L51.6084 82.9017C48.3624 72.58 54.0976 61.5836 64.4193 58.3376Z" fill="#F37E7C"/>
                      <path d="M89.5282 110.008C91.3863 109.51 92.4391 107.415 91.8798 105.328C91.3205 103.241 89.3608 101.954 87.5028 102.452C85.6447 102.95 84.5918 105.045 85.1512 107.132C85.7105 109.218 87.6702 110.506 89.5282 110.008Z" fill="black"/>
                      <path d="M114.164 103.399C116.022 102.901 117.075 100.805 116.516 98.7186C115.957 96.6319 113.997 95.344 112.139 95.8421C110.281 96.3401 109.228 98.4354 109.787 100.522C110.346 102.609 112.306 103.897 114.164 103.399Z" fill="black"/>
                      <path d="M110.201 128.638L108.678 129.048C101.229 131.036 93.5242 126.887 91.0897 119.575L86.8862 106.937L90.3055 105.815L94.4907 118.435C96.3417 123.933 102.141 127.061 107.748 125.574L109.271 125.164C114.332 123.805 117.332 118.608 115.973 113.548C115.927 113.365 115.873 113.192 115.809 113.019L111.587 100.317L115.006 99.1957L119.228 111.879C121.499 118.745 117.778 126.149 110.912 128.428C110.675 128.501 110.438 128.574 110.201 128.638Z" fill="black"/>
                      <path d="M53.1403 14.6528C53.7968 14.1057 74.5222 0 74.5222 0L78.8715 21.6555L90.8071 14.3975L82.227 67.6471L75.1513 37.3204L60.2159 45.1254L53.1403 14.6528Z" fill="white"/>
                      <path d="M103.472 4.32196L121.088 10.0755L95.6489 38.9342L103.472 4.32196Z" fill="white"/>
                      </g>
                      <g clip-path="url(#clip1_46_668)">
                      <path d="M110.315 70.7299C108.615 71.1855 107.408 72.089 106.695 73.4402L106.115 72.9755C106.589 71.7313 107.535 70.7591 108.951 70.0588C109.395 69.8348 109.869 69.6553 110.374 69.5201C111.354 69.2574 112.285 69.1932 113.165 69.3276C114.047 69.4678 114.842 69.7607 115.551 70.2064C117.019 71.1276 117.994 72.4893 118.477 74.2915C118.986 76.1916 118.906 77.9687 118.238 79.6227C117.789 80.7365 117.065 81.6279 116.066 82.2968C115.56 82.6298 115.069 82.8602 114.593 82.9877C114.111 83.1168 113.753 83.1973 113.518 83.2293C113.278 83.2628 113.061 83.2808 112.868 83.2833C112.674 83.2858 112.499 83.2773 112.342 83.2577C112.18 83.2453 112.007 83.2332 111.821 83.2211C111.314 83.1845 110.918 83.2041 110.634 83.28C110.351 83.3559 110.105 83.6748 109.898 84.2365L109.081 84.4552L108.986 79.5747L109.793 79.3583C109.884 79.8093 109.953 80.124 110.001 80.3025C110.103 80.6825 110.237 81.0043 110.405 81.2679C110.569 81.5388 110.783 81.7498 111.049 81.9009C111.314 82.0519 111.61 82.1608 111.938 82.2272C112.593 82.3602 113.269 82.3333 113.966 82.1465C114.658 81.9613 115.215 81.6607 115.638 81.245C116.056 80.8307 116.369 80.3333 116.578 79.7528C116.967 78.6426 117.008 77.2648 116.7 75.6192L111.217 77.0884L111.185 76.051L116.464 74.6364C116.048 73.31 115.297 72.2523 114.211 71.4633C113.014 70.5993 111.715 70.3548 110.315 70.7299ZM104.477 72.0998L104.108 72.2542C103.625 72.4699 103.335 72.6341 103.238 72.7466C103.061 72.9482 103.025 73.2448 103.13 73.6364L106.25 85.2788L105.596 85.7315L94.366 77.2807L96.5344 85.3734C96.6825 85.9261 96.8923 86.2556 97.1637 86.3618C97.3678 86.4429 97.8296 86.421 98.5494 86.296L98.7461 87.0302L94.2574 88.2329L94.0607 87.4988C94.3518 87.3838 94.5918 87.2824 94.7811 87.1947C94.9717 87.1127 95.1149 87.0127 95.2108 86.8944C95.3845 86.6812 95.3972 86.2983 95.2491 85.7455L92.2082 74.3968L92.8182 74.0204L104.129 82.5331L101.91 74.2504C101.777 73.7552 101.574 73.4516 101.301 73.3396C101.104 73.2627 100.811 73.2456 100.422 73.2883C100.034 73.3367 99.8014 73.365 99.7247 73.3732L99.5326 72.6564L104.285 71.383L104.477 72.0998ZM85.7585 89.7048L85.9599 90.4562L81.5646 91.6339L81.3633 90.8825C81.8507 90.684 82.2309 90.3569 82.5037 89.9012C82.5959 89.7469 82.6885 89.5709 82.7813 89.3732L85.0063 83.8709L75.8694 76.7382L76.3157 76.091L86.9171 82.7387L84.6952 88.3883C84.4218 88.9553 84.3207 89.3711 84.3916 89.636C84.4642 89.9066 84.9198 89.9295 85.7585 89.7048ZM89.5059 76.1113L89.2199 76.2343C88.7227 76.4415 88.4393 76.6193 88.3697 76.7675C88.2943 76.9173 88.2673 77.0881 88.2883 77.28C88.3108 77.4776 88.3669 77.7433 88.4564 78.0773L90.7753 86.7314C90.9511 87.3878 91.124 87.7611 91.294 87.8513C91.4582 87.9431 91.6442 87.9797 91.8519 87.961C92.0553 87.9497 92.3226 87.9151 92.6533 87.8574L92.8546 88.6088L88.1872 89.8594L87.9859 89.108C88.3069 88.9911 88.562 88.8888 88.7511 88.8011C88.9361 88.7207 89.0666 88.6179 89.1424 88.4926C89.218 88.3675 89.2448 88.206 89.2222 88.0084C89.1995 87.8108 89.1421 87.5393 89.0495 87.1938L86.7306 78.5397C86.5578 77.8948 86.3977 77.5243 86.2504 77.428C86.0976 77.3332 85.9335 77.2876 85.7583 77.2914C85.5789 77.3024 85.3394 77.3265 85.0396 77.3636L84.6601 77.4098L84.468 76.6929L89.3138 75.3945L89.5059 76.1113ZM69.7112 80.2119C71.3916 80.6565 72.6993 81.1732 73.6346 81.7618C74.7228 82.4453 75.6301 83.4056 76.3564 84.6427C77.0963 85.9071 77.7692 87.6707 78.3756 89.9335C78.553 90.5957 78.7055 90.9837 78.8332 91.0976C79.0438 91.2942 79.4367 91.3432 80.0117 91.2447L80.213 91.9961L75.8518 93.1647L75.6504 92.4133C76.2075 92.2023 76.5475 91.9754 76.6707 91.7326C76.7873 91.51 76.7437 91.0188 76.5401 90.2587C76.3364 89.4987 76.1194 88.7453 75.8889 87.9986C75.66 87.2577 75.4199 86.6 75.1689 86.0254C74.912 85.4525 74.6346 84.9498 74.3366 84.5174C74.04 84.0909 73.693 83.7025 73.2953 83.3524C72.5888 82.7332 71.5044 82.0981 70.0422 81.447C69.1338 82.7271 68.5351 83.8133 68.2456 84.7054C67.9509 85.6237 67.8797 86.695 68.0316 87.9194C68.1485 88.8322 68.5032 90.3942 69.0957 92.6052C69.2407 93.1464 69.3978 93.4716 69.5666 93.5806C69.8381 93.7547 70.2649 93.7946 70.8471 93.7003L71.0484 94.4517L66.7042 95.6158L66.5029 94.8644C67.0285 94.6495 67.331 94.4296 67.4103 94.2047C67.4831 94 67.3992 93.4486 67.1585 92.5503C66.9178 91.6521 66.7232 90.7446 66.5748 89.8279C66.4206 88.9126 66.3429 88.0787 66.3418 87.3261C66.3406 86.5736 66.414 85.8843 66.5622 85.2583C66.7047 84.6339 66.917 84.0432 67.199 83.4862C67.6821 82.5237 68.5196 81.4322 69.7112 80.2119Z" fill="white"/>
                      </g>
                      </g>
                      <defs>
                      <clipPath id="clip0_46_668">
                      <rect width="182" height="186" fill="white"/>
                      </clipPath>
                      <clipPath id="clip1_46_668">
                      <rect width="55.5355" height="16.9021" fill="white" transform="translate(120.481 81.7547) rotate(165)"/>
                      </clipPath>
                      </defs>
                      </svg>

                      </span>
                      <p className="text-3xl font-bold">Your Enku Bag is Empty</p>
                      <p className="text-lg">Use our beauty guide to find your perfect match.</p>
                      <div className="mt-4">
                        <Button className="px-20 py-6 text-lg">Discover Now</Button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          )}
        </div>
        {items.length > 0 && (
          <div className="p-4 border-t border-gray-200">
            <Button variant="default" color="primary" onClick={() => dispatch(clearCart())}>
              Clear Cart
            </Button>
          </div>
        )}
      </div>
    </Drawer>
  );
};

export default CartDrawer;