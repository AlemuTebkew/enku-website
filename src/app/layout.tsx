import {Suspense} from 'react'
import type { Metadata } from "next";;
import axios from 'axios';
import { Inter } from "next/font/google";
import "./globals.css";
import Header from "@/components/Header";
import Nav from "@/components/Nav";
import ProductList from "@/features/products/pages/ProductList";
import {Category} from '../models/category'
import { Brand } from "@/models/brand";

const inter = Inter({ subsets: ["latin"] });

export const metadata: Metadata = {
  title: "Create Next App",
  description: "Generated by create next app",
};

export default async function RootLayout({
  children,
}: Readonly<{
  children: React.ReactNode;
}>) {
  const {categories, brands} = await getData()
  return (
    <html lang="en">
      <body className={`${inter.className} bg-[#f3f3f3]`}>
        {/* <Header/> */}
        <Suspense fallback={<div>Loading...</div>}>
         <Nav categories={categories} brands={brands}/>
         {children}
        </Suspense>
        </body>
    </html>
  );
}



async function getData() {
  let categories:Category[] = [];
  let brands: Brand[] = [];

  try {
    const categoriesResponse = await axios.get('http://ec2-3-91-23-59.compute-1.amazonaws.com:5000/user/categories')
    const brandsResponse = await axios.get('http://ec2-3-91-23-59.compute-1.amazonaws.com:5000/admin/brands')

    categories = categoriesResponse.data.data
    brands = brandsResponse.data.data;

    console.log(brandsResponse)

  } catch (error) {
    console.error('Error fetching data:', error);
  }

  return {
    categories,
    brands
}
}